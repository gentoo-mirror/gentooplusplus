[Unit]
Description=Funkwhale celery worker
After=redis.service postgresql.service
PartOf=funkwhale.target

[Service]
User=media
WorkingDirectory=/var/www/funkwhale/api
Environment="CELERYD_CONCURRENCY=0"
EnvironmentFile=/var/www/funkwhale/config/.env

ExecStart=/var/www/funkwhale/venv/bin/celery \
    --app funkwhale_api.taskapp \
    worker \
    --loglevel INFO \
    --concurrency=${CELERYD_CONCURRENCY}

[Install]
WantedBy=multi-user.target
